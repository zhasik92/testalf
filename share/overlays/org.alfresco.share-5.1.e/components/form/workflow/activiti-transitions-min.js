(function(){var f=YAHOO.util.Dom,k=YAHOO.util.Event;var d=Alfresco.util.encodeHTML;Alfresco.ActivitiTransitions=function(m){Alfresco.ActivitiTransitions.superclass.constructor.call(this,"Alfresco.ActivitiTransitions",m,["button","container"]);YAHOO.Bubbling.on("formValidationError",this.onFormValidationError,this);return this};YAHOO.extend(Alfresco.ActivitiTransitions,Alfresco.component.Base,{options:{currentValue:"",hiddenFieldName:"",transitions:null},onReady:function a(){this._processTransitions();this._generateTransitionButtons()},onFormValidationError:function l(n,m){this._removeHiddenFields()},onClick:function c(p,q){q.set("disabled",true);var o=q.get("id");var n=o.substring(this.id.length+1);var m=this._getHiddenField();f.setAttribute(m,"value",n);if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Set transitions hidden field to: "+n)}this._generateTransitionsHiddenField();Alfresco.util.submitForm(q.getForm())},_processTransitions:function j(){this.options.transitions=[];if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Processing transitions for field '"+this.id+"': "+this.options.currentValue)}if(this.options.currentValue!==null&&this.options.currentValue.length>0){var p=this.options.currentValue.split("#alf#");for(var n=0,o=p.length;n<o;n++){var m=p[n].split("|");this.options.transitions.push({id:m[0],label:m[1]})}}if(Alfresco.logger.isDebugEnabled()){Alfresco.logger.debug("Built transitions list: "+YAHOO.lang.dump(this.options.transitions))}},_generateTransitionButtons:function g(){for(var m=0,n=this.options.transitions.length;m<n;m++){this._generateTransitionButton(this.options.transitions[m])}},_generateTransitionButton:function e(n){var m=document.createElement("input");m.setAttribute("id",this.id+"-"+n.id);m.setAttribute("value",n.label);m.setAttribute("type","button");f.get(this.id+"-buttons").appendChild(m);var m=Alfresco.util.createYUIButton(this,n.id,this.onClick);YAHOO.Bubbling.fire("addSubmitElement",m)},_getHiddenField:function b(){var m=f.get(this.id+"-hidden");if(m===null){m=document.createElement("input");m.setAttribute("id",this.id+"-hidden");m.setAttribute("type","hidden");m.setAttribute("name",this.options.hiddenFieldName);f.get(this.id).appendChild(m)}return m},_generateTransitionsHiddenField:function h(){var m=f.get(this.id+"-transitions-hidden");if(m===null){m=document.createElement("input");m.setAttribute("id",this.id+"-transitions-hidden");m.setAttribute("type","hidden");m.setAttribute("name","prop_transitions");m.setAttribute("value","Next");f.get(this.id).appendChild(m)}},_removeHiddenFields:function i(){var m=f.get(this.id+"-hidden");if(m!=null){f.get(this.id).removeChild(m)}var n=f.get(this.id+"-transitions-hidden");if(n!=null){f.get(this.id).removeChild(n)}}})})();