define(["alfresco/forms/controls/BaseFormControl","dojo/_base/declare","alfresco/core/CoreWidgetProcessing","dijit/form/ToggleButton","cmm/forms/controls/ColorButton","dojo/_base/lang","dojo/dom-class","dijit/registry"],function(p,h,a,c,g,b,n,o){return h([p,a],{i18nRequirements:[{i18nFile:"./i18n/SimpleStyle.properties"}],cssRequirements:[{cssFile:"./css/SimpleStyle.css"}],_cssForBold:"font-weight:bold;",_cssForItalic:"font-style:italic;",_cssForUnderline:"text-decoration:underline;",_cssForColor:"color:*;",_cssForBackgroundColor:"background-color:*;",widgetsForControl:null,_defControlState:{bold:false,italic:false,underline:false,color:"",background:""},getWidgetConfig:function d(){return{id:this.generateUuid(),name:this.name}},createFormControl:function e(r,s){_this=this;this.controlState=b.clone(this._defControlState);n.add(this.domNode,"cmm-forms-controls-SimpleStyle"+(this.additionalCssClasses?" "+this.additionalCssClasses:""));var t=null;if(this.widgetsForControl===null){t=[{id:this.fieldId+"_bold",name:"dijit/form/ToggleButton",config:{label:this.message("button.label.bold"),showLabel:false,iconClass:"bold",onChange:function(u){_this.onValueSet({property:"bold",value:u})}}},{id:this.fieldId+"_italic",name:"dijit/form/ToggleButton",config:{label:this.message("button.label.italic"),showLabel:false,iconClass:"italic",onChange:function(u){_this.onValueSet({property:"italic",value:u})}}},{id:this.fieldId+"_underline",name:"dijit/form/ToggleButton",config:{label:this.message("button.label.underlined"),showLabel:false,iconClass:"underlined",onChange:function(u){_this.onValueSet({property:"underline",value:u})}}},{name:"dijit/ToolbarSeparator"},{id:this.fieldId+"_color",name:"cmm/forms/controls/ColorButton",config:{label:this.message("button.label.color"),showLabel:false,iconClass:"color",onChange:function(u){_this.onValueSet({property:"color",value:u})}}},{id:this.fieldId+"_background",name:"cmm/forms/controls/ColorButton",config:{label:this.message("button.label.background"),showLabel:false,iconClass:"background",onChange:function(u){_this.onValueSet({property:"background",value:u})}}}]}else{t=b.clone(this.widgetsForControl);this.processObject(["processInstanceTokens"],t)}return this.processWidgets(t,this._controlNode)},getValue:function j(){var r=this._composeValue();this.alfLog("log","Returning value for field: '"+this.name+"': ",r);return r},onValueSet:function f(s){this.controlState[b.getObject("property",false,s)]=b.getObject("value",false,s);var r=this._composeValue();this.onValueChangeEvent(this.name,this.lastValue,r);this.lastValue=r},setValue:function q(r){if(this.deferValueAssigment){this.inherited(arguments)}else{this.alfLog("log","Setting field: '"+this.name+"' with value: ",r);this.controlState=b.clone(this._defControlState);r.split(";").forEach(function(t){if(t!=""){var s=t.split(":");switch(s[0]){case"font-weight":this.controlState.bold=s[1]==="bold";break;case"font-style":this.controlState.italic=s[1]==="italic";break;case"text-decoration":this.controlState.underline=s[1]==="underline";break;case"color":this.controlState.color=s[1];break;case"background-color":this.controlState.background=s[1];break;default:break}}},this);this._setControlStates()}},placeWidget:function l(){},setupChangeEvents:function m(){},_composeValue:function k(){var r="";if(this.controlState.bold){r=r+this._cssForBold}if(this.controlState.italic){r=r+this._cssForItalic}if(this.controlState.underline){r=r+this._cssForUnderline}if(this.controlState.color){r=r+this._cssForColor.replace("*",this.controlState.color)}if(this.controlState.background){r=r+this._cssForBackgroundColor.replace("*",this.controlState.background)}return r},_setControlStates:function i(){o.byId(this.fieldId+"_bold").set("checked",this.controlState.bold);o.byId(this.fieldId+"_italic").set("checked",this.controlState.italic);o.byId(this.fieldId+"_underline").set("checked",this.controlState.underline);o.byId(this.fieldId+"_color").set("value",this.controlState.color);o.byId(this.fieldId+"_background").set("value",this.controlState.background)}})});