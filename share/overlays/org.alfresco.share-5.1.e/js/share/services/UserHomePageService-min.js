define(["dojo/_base/declare","dojo/_base/lang","dojo/dom","dojo/dom-attr","alfresco/core/Core","alfresco/services/_UserServiceTopicMixin"],function(g,b,f,j,c,d){return g([c,d],{TOPIC_SET_CURRENT_PAGE_AS_HOME:"ALF_SET_CURRENT_PAGE_AS_HOME",_lastSeenHomePageRequest:null,constructor:function k(l){g.safeMixin(this,l);b.mixin(this,l);this.alfSubscribe(this.TOPIC_SET_CURRENT_PAGE_AS_HOME,b.hitch(this,this.onSetCurrentPageAsHome));this.alfSubscribe(this.setUserHomePageTopic,b.hitch(this,this.onSetHomePage));this.alfSubscribe(this.setUserHomePageSuccessTopic,b.hitch(this,this.onSetHomePageSuccess));this.alfSubscribe(this.setUserHomePageFailureTopic,b.hitch(this,this.onSetHomePageFailure))},onSetCurrentPageAsHome:function e(m){if(m&&m.servletContext){var l=window.location.href;l=l.replace(window.location.origin+m.servletContext,"/page");this.alfPublish(this.setUserHomePageTopic,{homePage:l})}},onSetHomePage:function h(l){if(l&&l.homePage){this._lastSeenHomePageRequest=l.homePage}},onSetHomePageSuccess:function i(l){if(this._lastSeenHomePageRequest){var m=f.byId("HEADER_HOME_text");if(m){location.reload()}}},onSetHomePageFailure:function a(l){this._lastSeenHomePageRequest=null}})});